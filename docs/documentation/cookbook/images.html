
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Images Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="datatypes.html" />
    
    
    <link rel="prev" href="bookmark.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../installation.html">
            
                <a href="../installation.html">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    API
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../action.html">
            
                <a href="../action.html">
            
                    
                    Action
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../annotations.html">
            
                <a href="../annotations.html">
            
                    
                    Annotation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../array.html">
            
                <a href="../array.html">
            
                    
                    Array
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../bestpractices.html">
            
                <a href="../bestpractices.html">
            
                    
                    Best Practices
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../checkbox.html">
            
                <a href="../checkbox.html">
            
                    
                    CheckBox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../color.html">
            
                <a href="../color.html">
            
                    
                    Color
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../combobox.html">
            
                <a href="../combobox.html">
            
                    
                    ComboBox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../configure.html">
            
                <a href="../configure.html">
            
                    
                    Configure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../contentstokenizer.html">
            
                <a href="../contentstokenizer.html">
            
                    
                    ContentsTokenizer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../data.html">
            
                <a href="../data.html">
            
                    
                    Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.11" data-path="../date.html">
            
                <a href="../date.html">
            
                    
                    Date
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.12" data-path="../destination.html">
            
                <a href="../destination.html">
            
                    
                    Destination
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.13" data-path="../dictionary.html">
            
                <a href="../dictionary.html">
            
                    
                    Dictionary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.14" data-path="../document.html">
            
                <a href="../document.html">
            
                    
                    Document
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.15" data-path="../encoding.html">
            
                <a href="../encoding.html">
            
                    
                    Encoding
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.16" data-path="../encrypt.html">
            
                <a href="../encrypt.html">
            
                    
                    Encrypt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.17" data-path="../extgstate.html">
            
                <a href="../extgstate.html">
            
                    
                    ExtGState
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.18" data-path="../field.html">
            
                <a href="../field.html">
            
                    
                    Field
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.19" data-path="../filespec.html">
            
                <a href="../filespec.html">
            
                    
                    FileSpec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.20" data-path="../font.html">
            
                <a href="../font.html">
            
                    
                    Font
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.21" data-path="../form.html">
            
                <a href="../form.html">
            
                    
                    Form
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.22" data-path="../image.html">
            
                <a href="../image.html">
            
                    
                    Image
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.23" data-path="../listbox.html">
            
                <a href="../listbox.html">
            
                    
                    ListBox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.24" data-path="../listfield.html">
            
                <a href="../listfield.html">
            
                    
                    ListField
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.25" data-path="../object.html">
            
                <a href="../object.html">
            
                    
                    Object
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.26" data-path="../outline.html">
            
                <a href="../outline.html">
            
                    
                    Outline
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.27" data-path="../page.html">
            
                <a href="../page.html">
            
                    
                    Page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.28" data-path="../painter.html">
            
                <a href="../painter.html">
            
                    
                    Painter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.29" data-path="../pushbutton.html">
            
                <a href="../pushbutton.html">
            
                    
                    PushButton
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.30" data-path="../rect.html">
            
                <a href="../rect.html">
            
                    
                    Rect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.31" data-path="../ref.html">
            
                <a href="../ref.html">
            
                    
                    Ref
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.32" data-path="../signaturefield.html">
            
                <a href="../signaturefield.html">
            
                    
                    SignatureField
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.33" data-path="../signer.html">
            
                <a href="../signer.html">
            
                    
                    Signer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.34" data-path="../simpletable.html">
            
                <a href="../simpletable.html">
            
                    
                    SimpleTable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.35" data-path="../textfield.html">
            
                <a href="../textfield.html">
            
                    
                    TextField
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.36" data-path="../xobject.html">
            
                <a href="../xobject.html">
            
                    
                    XObject
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Cookbook
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="ap.html">
            
                <a href="ap.html">
            
                    
                    AP
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="bookmark.html">
            
                <a href="bookmark.html">
            
                    
                    Bookmarks
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.1.2" data-path="images.html">
            
                <a href="images.html">
            
                    
                    Images
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="datatypes.html">
            
                <a href="datatypes.html">
            
                    
                    Data Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="signer.html">
            
                <a href="signer.html">
            
                    
                    Signer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.5" data-path="table.html">
            
                <a href="table.html">
            
                    
                    Table
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Images</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="image-cookbook">Image Cookbook</h1>
<h2 id="get-all-document-images">Get all document images</h2>
<pre><code class="lang-typescript"><span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">new</span> npdf.Document()
doc.load(<span class="hljs-string">&apos;/path/to/document.pdf&apos;</span>, (err, data) =&gt; {
  <span class="hljs-keyword">if</span>(e) {<span class="hljs-comment">/* handle error */</span>}
  <span class="hljs-comment">// iterate the document body, filter type XObject with subtype Image</span>
  <span class="hljs-comment">// iterating the body can be expensive in terms of javascript / c++ copy overhead</span>
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; doc.body.length; i++) {
    <span class="hljs-keyword">const</span> o = doc.body[i]
    <span class="hljs-keyword">if</span> (o.type === <span class="hljs-string">&apos;Dictionary&apos;</span>) {
        <span class="hljs-keyword">let</span> objDict = o.getDictionary(),
            objType = objDict.hasKey(<span class="hljs-string">&apos;Type&apos;</span>) ? objDict.getKeyType(<span class="hljs-string">&apos;Type&apos;</span>) : <span class="hljs-literal">null</span>,
            objSubType = objDict.hasKey(<span class="hljs-string">&apos;SubType&apos;</span>) ? objDict.getKeyType(<span class="hljs-string">&apos;SubType&apos;</span>) : <span class="hljs-literal">null</span>

        <span class="hljs-keyword">if</span> ((objType &amp;&amp; objType === <span class="hljs-string">&apos;Name&apos;</span>) ||
            (objSubType &amp;&amp; objSubType === <span class="hljs-string">&apos;Name&apos;</span>)) {

            <span class="hljs-keyword">if</span> ((objType &amp;&amp; objDict.getKey&lt;<span class="hljs-built_in">String</span>&gt;(<span class="hljs-string">&apos;Type&apos;</span>) === <span class="hljs-string">&apos;XObject&apos;</span>) || (objSubType &amp;&amp; objDict.getKey&lt;<span class="hljs-built_in">String</span>&gt;(<span class="hljs-string">&apos;SubType&apos;</span>) === <span class="hljs-string">&apos;Image&apos;</span>)) {
                <span class="hljs-keyword">if</span> (objDict.hasKey(<span class="hljs-string">&apos;Filter&apos;</span>)) {
                    <span class="hljs-keyword">if</span> (objDict.getKeyType(<span class="hljs-string">&apos;Filter&apos;</span>) === <span class="hljs-string">&apos;Array&apos;</span>) {
                        <span class="hljs-keyword">const</span> imgObjArr = objDict.getKey&lt;npdf.Array&gt;(<span class="hljs-string">&apos;Filter&apos;</span>)
                        <span class="hljs-keyword">if</span> (imgObjArr.length === <span class="hljs-number">1</span>) {
                            <span class="hljs-keyword">if</span> ((imgObjArr.at(<span class="hljs-number">0</span>) as npdf.Object).type === <span class="hljs-string">&apos;Name&apos;</span>) {
                                <span class="hljs-keyword">if</span> ((imgObjArr.at(<span class="hljs-number">0</span>) as npdf.Object).getName() === <span class="hljs-string">&apos;DCTDecode&apos;</span>) {
                                    extractImg(o, <span class="hljs-literal">true</span>)
                                    <span class="hljs-keyword">return</span>
                                }
                            }
                        }
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (objDict.getKeyType(<span class="hljs-string">&apos;Filter&apos;</span>) === <span class="hljs-string">&apos;Name&apos;</span> &amp;&amp; objDict.getKey&lt;<span class="hljs-built_in">String</span>&gt;(<span class="hljs-string">&apos;Filter&apos;</span>) === <span class="hljs-string">&apos;DCTDecode&apos;</span>) {
                        extractImg(o, <span class="hljs-literal">true</span>)
                        <span class="hljs-keyword">return</span>
                    }
                }
            }
        }
    }
  }
})
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">extractImg</span>(<span class="hljs-params">obj: npdf.<span class="hljs-built_in">Object</span>, jpg: <span class="hljs-built_in">Boolean</span></span>) </span>{
    <span class="hljs-keyword">let</span> ext = jpg ? <span class="hljs-string">&apos;.jpg&apos;</span> : <span class="hljs-string">&apos;.ppm&apos;</span>
    writeFile(<span class="hljs-string">`/tmp/<span class="hljs-subst">${v4()}</span>.<span class="hljs-subst">${ext}</span>`</span>, obj.stream, err =&gt; {
        <span class="hljs-keyword">if</span> (err <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span>) { <span class="hljs-comment">/* handle error */</span>}
    })
}
</code></pre>
<h2 id="get-an-image-from-a-specific-page">Get an image from a specific page</h2>
<p>Getting images from a page is similar to the above with the exception that instead of iterating the document&apos;s body
we will inspect a page&apos;s resources dictionary. This method will only work if the image has been set in the page&apos;s resources.
If the image is an inline object the following method will not work, for finding inline images the above method must be used.</p>
<pre><code class="lang-typescript"><span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">new</span> npdf.Document()
doc.load(<span class="hljs-string">&apos;/path/to/doc&apos;</span>, e =&gt; {
    <span class="hljs-keyword">if</span> (e <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span>) t.fail()
    <span class="hljs-keyword">const</span> page = doc.getPage(<span class="hljs-number">0</span>)
    <span class="hljs-keyword">let</span> resource = page.resources.getDictionary().getKey&lt;npdf.Dictionary&gt;(<span class="hljs-string">&apos;XObject&apos;</span>)
    <span class="hljs-keyword">let</span> xKey = resource.getKeys()
    <span class="hljs-keyword">let</span> xob = resource.getKey&lt;npdf.Dictionary&gt;(<span class="hljs-string">&apos;XOb4&apos;</span>)
    <span class="hljs-keyword">if</span>(xob.getKey&lt;<span class="hljs-built_in">String</span>&gt;(NPDFName.SUBTYPE) === <span class="hljs-string">&apos;Image&apos;</span>) {
        <span class="hljs-keyword">if</span>(xob.hasKey(<span class="hljs-string">&apos;Filter&apos;</span>) &amp;&amp; xob.getKey&lt;<span class="hljs-built_in">String</span>&gt;(<span class="hljs-string">&apos;Filter&apos;</span>) === <span class="hljs-string">&apos;DCTDecode&apos;</span>) {
            extractImg(xob.obj, <span class="hljs-literal">true</span>)
        } <span class="hljs-keyword">else</span> {
            extractImg(xob.obj, <span class="hljs-literal">true</span>)
        }
    }
})
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">extractImg</span>(<span class="hljs-params">obj: npdf.<span class="hljs-built_in">Object</span>, jpg: <span class="hljs-built_in">Boolean</span></span>) </span>{
    <span class="hljs-comment">// img data is accessable via npdf.Object.stream</span>
}
</code></pre>
<h2 id="set-an-image">Set an image</h2>
<pre><code class="lang-typescript"><span class="hljs-keyword">import</span> {nopodofo as npdf} from <span class="hljs-string">&apos;nopodofo&apos;</span>
<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">new</span> npdf.StreamDocument()
<span class="hljs-keyword">const</span> page = doc.createPage(<span class="hljs-keyword">new</span> npdf.Rect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">612</span>, <span class="hljs-number">792</span>))
<span class="hljs-keyword">const</span> painter = <span class="hljs-keyword">new</span> npdf.Painter(doc)
<span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> npdf.Image(doc, join(__dirname, <span class="hljs-string">&apos;../../spec/test-documents/test.jpg&apos;</span>))
painter.setPage(page)
painter.drawImage(img, <span class="hljs-number">0</span>, page.height - img.height)
painter.finishPage()
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="bookmark.html" class="navigation navigation-prev " aria-label="Previous page: Bookmarks">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="datatypes.html" class="navigation navigation-next " aria-label="Next page: Data Types">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({
                "page": {
                    "title": "Images",
                    "level": "1.4.1.2",
                    "depth": 3,
                    "next": {
                        "title": "Data Types",
                        "level": "1.4.1.3",
                        "depth": 3,
                        "path": "documentation/cookbook/datatypes.md",
                        "ref": "documentation/cookbook/datatypes.md",
                        "articles": []
                    },
                    "previous": {
                        "title": "Bookmarks",
                        "level": "1.4.1.1",
                        "depth": 3,
                        "path": "documentation/cookbook/bookmark.md",
                        "ref": "documentation/cookbook/bookmark.md",
                        "articles": []
                    },
                    "dir": "ltr"
                },
                "config": {
                    "gitbook": "*",
                    "theme": "default",
                    "variables": {},
                    "plugins": [],
                    "pluginsConfig": {
                        "highlight": {},
                        "search": {},
                        "lunr": {"maxIndexSize": 1000000, "ignoreSpecialCharacters": false},
                        "sharing": {
                            "facebook": true,
                            "twitter": true,
                            "google": false,
                            "weibo": false,
                            "instapaper": false,
                            "vk": false,
                            "all": ["facebook", "google", "twitter", "weibo", "instapaper"]
                        },
                        "fontsettings": {"theme": "white", "family": "sans", "size": 2},
                        "theme-default": {
                            "styles": {
                                "website": "styles/website.css",
                                "pdf": "styles/pdf.css",
                                "epub": "styles/epub.css",
                                "mobi": "styles/mobi.css",
                                "ebook": "styles/ebook.css",
                                "print": "styles/print.css"
                            }, "showLevel": false
                        }
                    },
                    "structure": {
                        "langs": "LANGS.md",
                        "readme": "README.md",
                        "glossary": "GLOSSARY.md",
                        "summary": "SUMMARY.md"
                    },
                    "pdf": {
                        "pageNumbers": true,
                        "fontSize": 12,
                        "fontFamily": "Arial",
                        "paperSize": "a4",
                        "chapterMark": "pagebreak",
                        "pageBreaksBefore": "/",
                        "margin": {"right": 62, "left": 62, "top": 56, "bottom": 56}
                    },
                    "styles": {
                        "website": "styles/website.css",
                        "pdf": "styles/pdf.css",
                        "epub": "styles/epub.css",
                        "mobi": "styles/mobi.css",
                        "ebook": "styles/ebook.css",
                        "print": "styles/print.css"
                    }
                },
                "file": {
                    "path": "documentation/cookbook/images.md",
                    "mtime": "2019-04-26T23:00:50.728Z",
                    "type": "markdown"
                },
                "gitbook": {"version": "3.2.3", "time": "2019-08-09T15:33:50.611Z"},
                "basePath": "../..",
                "book": {"language": ""}
            });
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

